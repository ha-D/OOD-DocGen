/*! docgen 04-06-2015 */
function UseCasePageCtrlImpl(a,b,c,d,e){a.dragEnabled=!0,a.data={};var f={};a.configFactory=function(b){if(f[b])return f[b];var d={group:"subsystems",index:b,disabled:!a.dragEnabled,onSort:function(b){b.models;c(function(){a.save()})}};return f[b]=d,d},a.openUsecaseForm=function(a){return d.show({templateUrl:"partials/usecase_dialog.html",locals:{usecase:a},controller:"UseCaseDetailsCtrl"})},a.openUsecase=function(b){a.openUsecaseForm(b).then(function(){a.save()})},a.newUsecase=function(b){var c={title:"",description:"",primaryActors:[],secondaryActors:[],preconditions:[],postconditions:[],mainflow:[],alternatives:[]};a.openUsecaseForm(c).then(function(){b.usecases.push(c),a.save()})},a.newSubsystem=function(){a.data.subsystems||(a.data.subsystems=[]),a.data.subsystems.push({name:a.newSubsystemName,usecases:[]}),a.newSubsystemName="",a.save()},a.deleteSubsystem=function(b){var c=d.confirm().content("You sure you want to delete "+b.name+"?").ok("Yes").cancel("No");d.show(c).then(function(){var c=a.data.subsystems.indexOf(b);-1!==c&&a.data.subsystems.splice(c,1)})},a.openEditDialog=function(){return d.show({templateUrl:"partials/usecase_edit.html",locals:{data:a.data},controller:"UseCaseEditJSONCtrl"}).then(function(b){a.data=b,a.save()})},a.openSnippetEditDialog=function(){return d.show({templateUrl:"partials/usecase_edit.html",locals:{data:a.data.snippets},controller:"UseCaseEditJSONCtrl"}).then(function(b){a.data.snippets=b,a.save()})},a.renderSubsystems=function(){function b(a){if(a&&"@"==a[0]){var b=a.split(" "),d=angular.copy(e[b[0].slice(1)]);if(d){for(var f=1;f<b.length;f++)d=c(d,"@"+f,b[f]);return d}}}function c(a,b,d){if("string"==typeof a){var e=new RegExp(b,"g");return a.replace(e,d)}if("object"==typeof a){for(var f in a)a[f]=c(a[f],b,d);return a}return a}function d(a){if("string"==typeof a){var c=b(a);return c?d(c):a}if("object"==typeof a){for(var e in a)a[e]=d(a[e]);return a}return a}var e=a.data.snippets;return d(angular.copy(a.data.subsystems))},a.createTexLink=function(){b.get("partials/usecase.tex").success(function(b){var c=Handlebars.compile(b),d=a.renderSubsystems(),e=c({subsystems:d});a.texContent=e,a.texLink=encodeURIComponent(e)})},a.clearTexLink=function(){a.texLink=""},a.save=function(){e.save({key:"usecase",subsystems:a.data.subsystems,snippets:a.data.snippets})},a.load=function(){e.get("usecase",function(b){b?(a.data.subsystems=b.subsystems,a.data.snippets=b.snippets):a.data={subsystems:[],snippets:{}}})},a.load()}function UseCasePageCtrl(a,b,c,d){new Lawnchair({name:"docgen"},function(e){UseCasePageCtrlImpl(a,b,c,d,this)})}function UseCaseDetailsCtrl(a,b,c){a.usecase=c,a.addPrecondition=function(b){var c=b.target.value;b.target.value="",a.usecase.preconditions.push(c)},a.removePrecondition=function(b){a.usecase.preconditions.splice(b,1)},a.addPostcondition=function(b){var c=b.target.value;b.target.value="",a.usecase.postconditions.push(c)},a.removePostcondition=function(b){a.usecase.postconditions.splice(b,1)},a.addAlternative=function(b){var c=b.target.value;b.target.value="",a.usecase.alternatives.push(c)},a.removeAlternative=function(b){a.usecase.alternatives.splice(b,1)},a.addFlow=function(b,c){var d=b.target.value;b.target.value="",c?c.subflow.push({text:d}):a.usecase.mainflow.push({text:d})},a.removeFlow=function(b,c){c?c.subflow.splice(b,1):a.usecase.mainflow.splice(b,1)},a.saveAndClose=function(){b.hide()}}function UseCaseEditJSONCtrl(a,b,c,d){a.jsonData=angular.toJson(d,4),a.saveAndClose=function(){try{var d=angular.fromJson(a.jsonData);b.hide(d)}catch(e){c.show(c.simple().content("Invalid JSON string"))}},a.close=function(){b.cancel()}}function CRCPageCtrlImpl(a,b,c,d,e){var f={className:"",description:"",superClass:"",responsibilities:[],collaborators:[]};a.state="",a.manual={content:""},a.tex={link:"",content:""},a.words=[],a.wordForm=angular.copy(f),a.clearForm=function(){a.wordForm=angular.copy(f),a.save()},a.addWord=function(){a.wordForm.className&&(a.words.push(a.wordForm),a.clearForm(),a.save())},a.removeWord=function(b){a.words.splice(b,1),a.save()},a.editWord=function(b){a.wordForm=b},a.manualEditStart=function(){a.state="edit",a.manual.content=angular.toJson(a.words,4)},a.manualEditSave=function(){try{a.words=angular.fromJson(a.manual.content),a.save()}catch(b){d.show(d.simple().content("Invalid JSON"))}a.state=""},a.manualEditCancel=function(){a.state=""},a.renderTex=function(){b.get("partials/crc.tex").success(function(b){var c=Handlebars.compile(b),d=a.words,e=c({words:d});a.tex.content=e,a.tex.link=encodeURIComponent(e),a.state="tex"})},a.texCancel=function(){a.tex.link="",a.tex.content="",a.state=""},a.sort=function(){a.words.sort(function(a,b){return a.word>b.word?1:a.word<b.word?-1:0})},a.save=function(){e.save({key:"crc",words:a.words})},a.load=function(){e.get("crc",function(b){b?a.words=b.words:a.words=[]})},a.load()}function CRCPageCtrl(a,b,c,d){new Lawnchair({name:"docgen"},function(e){CRCPageCtrlImpl(a,b,c,d,this)})}function GlossaryPageCtrlImpl(a,b,c,d,e){var f={word:"",definition:"",synonyms:[],antonyms:[]};a.state="",a.manual={content:""},a.tex={link:"",content:""},a.words=[],a.wordForm=angular.copy(f),a.clearForm=function(){a.wordForm=angular.copy(f),a.save()},a.addWord=function(){a.wordForm.word&&(a.words.push(a.wordForm),a.clearForm(),a.save())},a.removeWord=function(b){a.words.splice(b,1),a.save()},a.editWord=function(b){a.wordForm=b},a.manualEditStart=function(){a.state="edit",a.manual.content=angular.toJson(a.words,4)},a.manualEditSave=function(){try{a.words=angular.fromJson(a.manual.content),a.save()}catch(b){d.show(d.simple().content("Invalid JSON"))}a.state=""},a.manualEditCancel=function(){a.state=""},a.renderTex=function(){function c(){for(var b={},c=0;c<a.words.length;c++){var d=a.words[c];b[d.word[0]]||(b[d.word[0]]=[]),b[d.word[0]].push(d)}b["آ"]&&(b["ا"]?b["ا"].push(b["آ"]):b["ا"]=b["آ"],delete b["آ"]);var e=[];for(var f in b)e.push({letter:f,words:b[f]});return e.sort(function(a,b){return a.letter>b.letter?1:a.letter<b.letter?-1:0}),e}b.get("partials/glossary.tex").success(function(b){var d=Handlebars.compile(b),e=(a.words,d({wordCategories:c()}));a.tex.content=e,a.tex.link=encodeURIComponent(e),a.state="tex"})},a.texCancel=function(){a.tex.link="",a.tex.content="",a.state=""},a.sort=function(){a.words.sort(function(a,b){return a.word>b.word?1:a.word<b.word?-1:0})},a.save=function(){a.sort(),e.save({key:"glossary",words:a.words})},a.load=function(){e.get("glossary",function(b){b?a.words=b.words:a.words=[]})},a.load()}function GlossaryPageCtrl(a,b,c,d){new Lawnchair({name:"docgen"},function(e){GlossaryPageCtrlImpl(a,b,c,d,this)})}var app=angular.module("myApp",["ngMaterial","ngRoute","ng-sortable"]);app.config(["$routeProvider",function(a){a.when("/usecase",{templateUrl:"partials/usecases.html"}).when("/glossary",{templateUrl:"partials/glossary.html"}).when("/crc",{templateUrl:"partials/crc.html"})}]),app.config(["$compileProvider",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|data):/)}]),app.directive("ngEnter",function(){function a(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.ngEnter({event:b})}),b.preventDefault())})}return{link:a,scope:{ngEnter:"&"}}});var app=angular.module("myApp");app.controller("UseCasePageCtrl",["$scope","$http","$timeout","$mdDialog",UseCasePageCtrl]),app.controller("UseCaseDetailsCtrl",["$scope","$mdDialog","usecase",UseCaseDetailsCtrl]),app.controller("UseCaseEditJSONCtrl",["$scope","$mdDialog","$mdToast","data",UseCaseEditJSONCtrl]),app.controller("CRCPageCtrl",["$scope","$http","$timeout","$mdToast",CRCPageCtrl]),app.controller("GlossaryPageCtrl",["$scope","$http","$timeout","$mdToast",GlossaryPageCtrl]);var usecaseIndex=1;Handlebars.registerHelper("reset",function(){usecaseIndex=1}),Handlebars.registerHelper("incIndex",function(){usecaseIndex+=1}),Handlebars.registerHelper("index",function(){return usecaseIndex}),Handlebars.registerHelper("inc",function(a){return a+1}),Handlebars.registerHelper("flow",function(a,b){function c(a){d+="\\begin{enumerate}[itemsep=0pt,label*=\\arabic*.]\n";for(var b=0;b<a.length;b++)d+="\\item "+a[b].text+"\n",a[b].subflow&&a[b].subflow.length&&c(a[b].subflow);d+="\\end{enumerate}\n"}var d="";return c(a),d});